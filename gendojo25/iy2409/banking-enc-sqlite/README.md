# Simple Banking System with SQLite and Age Encryption

This script implements a basic banking system using SQLite for data storage and the `age` utility for optional encryption. 

## Features

* **Create Database Schema:** Sets up the necessary tables (accounts and transactions) if they don't exist.
* **Create Account:** Allows users to create new bank accounts.
* **Deposit:** Deposits money into an existing account.
* **Withdraw:** Withdraws money from an existing account.
* **Check Balance:** Displays the current balance of an account.
* **Transfer:** Transfers money between two accounts.
* **Print Tables (Debug):** Outputs the contents of the accounts and transactions tables (for debugging).
* **View Transaction History:** Displays a list of transactions, either for a specific account or all accounts.
* **Encrypt Database File:** Encrypts the database file using an Age public key.
* **Decrypt Database File:** Decrypts the encrypted database file using an Age secret key.
* **Create Age Key:** Generates a new Age key pair and stores it in a file.

## Usage

1. **Install Dependencies:**
   - Make sure you have `sqlite3` and `age` installed on your system.
2. **Run the Script:**
   ```bash
   docker compose run --rm bank101
   # bash banking.sh 
   ```
3. **Follow the Menu:** The script presents a menu with the available options. Choose the desired operation by entering the corresponding number.


## Encryption/Decryption

**Important:** Before using encryption, you must generate an Age key pair.

1. **Generate Age Key:**
   - Select option 11 ("Create Age Key") from the menu. 
   - This will generate a key pair and store the secret key in `/tmp/age-keys.txt` and output the public key. 
2. **Encrypt Database:**
   - Set the `AGE_PUB_KEY` environment variable to the public key generated in the previous step. 
   - Select option 9 ("Encrypt Database File") from the menu.
   - The original database file will be encrypted and replaced with the encrypted version.
3. **Decrypt Database:**
   - Set the `AGE_KEY_FILE` environment variable to the path of the secret key file (`/tmp/age-keys.txt`).
   - Select option 10 ("Decrypt Database File") from the menu. 

**Note:** 
- For security, ensure that the secret key file is protected and only accessible to authorized users.
- Be careful when handling encryption keys, as losing them will make it impossible to decrypt the data.


## Database File

The script stores data in a file named `bank.db`. The encrypted version of the database is stored in `bank.db.age`.

## Example

```
Banking System Menu:

  1. Create Database Schema
  2. Create Account
  ...
  12. Exit

Enter your choice: 2
Enter account name: John Doe
Account created for John Doe.

... (continue using the menu) ...
```

## Disclaimer

This is a simple demonstration and should not be used for real-world banking applications. It is intended for educational and learning purposes only. 

**Remember to replace placeholders in the README.md with specific details about your implementation if necessary.**

## Age Help

```sh
age --help
Usage:
    age [--encrypt] (-r RECIPIENT | -R PATH)... [--armor] [-o OUTPUT] [INPUT]
    age [--encrypt] --passphrase [--armor] [-o OUTPUT] [INPUT]
    age --decrypt [-i PATH]... [-o OUTPUT] [INPUT]

Options:
    -e, --encrypt               Encrypt the input to the output. Default if omitted.
    -d, --decrypt               Decrypt the input to the output.
    -o, --output OUTPUT         Write the result to the file at path OUTPUT.
    -a, --armor                 Encrypt to a PEM encoded format.
    -p, --passphrase            Encrypt with a passphrase.
    -r, --recipient RECIPIENT   Encrypt to the specified RECIPIENT. Can be repeated.
    -R, --recipients-file PATH  Encrypt to recipients listed at PATH. Can be repeated.
    -i, --identity PATH         Use the identity file at PATH. Can be repeated.

INPUT defaults to standard input, and OUTPUT defaults to standard output.
If OUTPUT exists, it will be overwritten.

RECIPIENT can be an age public key generated by age-keygen ("age1...")
or an SSH public key ("ssh-ed25519 AAAA...", "ssh-rsa AAAA...").

Recipient files contain one or more recipients, one per line. Empty lines
and lines starting with "#" are ignored as comments. "-" may be used to
read recipients from standard input.

Identity files contain one or more secret keys ("AGE-SECRET-KEY-1..."),
one per line, or an SSH key. Empty lines and lines starting with "#" are
ignored as comments. Passphrase encrypted age files can be used as
identity files. Multiple key files can be provided, and any unused ones
will be ignored. "-" may be used to read identities from standard input.

When --encrypt is specified explicitly, -i can also be used to encrypt to an
identity file symmetrically, instead or in addition to normal recipients.

Example:
    $ age-keygen -o key.txt
    Public key: age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p
    $ tar cvz ~/data | age -r age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p > data.tar.gz.age
    $ age --decrypt -i key.txt -o data.tar.gz data.tar.gz.age
```

# Banking101 - Simple Banking System

This project implements a basic banking system using Bash scripting and SQLite. It provides a command-line interface for managing bank accounts, performing transactions, and viewing account information.

## Prerequisites

- Docker
- Docker Compose

## File Structure

- `compose.yaml`: Docker Compose configuration file
- `Dockerfile`: Docker image definition for the banking application
- `banking.sh`: Main Bash script containing the banking system logic

## How to Run

1. Make sure you have Docker and Docker Compose installed on your system.
2. Clone this repository or ensure you have all the files in the same directory.
3. Open a terminal and navigate to the project directory.
4. Run the following command to start the application:

   ```
   docker compose run --rm bank101
   ```

This command will build the Docker image (if not already built) and run the banking application.